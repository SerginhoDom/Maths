-- FreeFem++ v4.6 (Fri, Apr 03, 2020  2:08:08 PM - git v4.6)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : load "medit"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\medit = 0)
    2 :
    3 : ofstream gnu("gamma and E.txt");
    4 :
    5 : real uMax = 5.;
    6 :
    7 : real Mu = 0.4;
    8 :
    9 : func fx = 0.;
   10 : func fy = 0.;
   11 :
   12 : border C1(t=0, 50.) {x=t; y=0; label=1;};
   13 : border C2(t=0, 10.) {x=50.; y=t; label=3;};
   14 : border C3(t=0, 50.) {x=50.-t; y=10.; label=1;};
   15 : border C4(t=0, 10.) {x=0; y=10.-t; label=2;};
   16 :
   17 : mesh Th = buildmesh (C1(50) + C2(10) + C3(50) + C4(10));
   18 :
   19 :
   20 :
   21 : medit("domain", Th);
   22 :
   23 : real a = 0.92, b = 18.7, k = 0.1, ka = 0.01, gamma = 10000, beta = 0.25, A = 1;
   24 : real ks = k - ka;
   25 : real alpha = 1 / (3 * k - A * ks);
   26 : real E;
   27 :
   28 :
   29 : fespace Vh(Th,P1);
   30 : Vh eta, theta, phi, xi, bigtheta, theta0;
   31 :
   32 : fespace Uh(Th, [P1, P1]);
   33 : Uh [ux, uy];
   34 : Uh [vx, vy];
   35 :
   36 : fespace Wh(Th, P1);
   37 : Wh uA;
   38 :
   39 : fespace Ph(Th, P1);
   40 : Ph p;
   41 : Ph q;
   42 :
   43 : uA=sqrt(ux*ux+uy*uy);
   44 :
   45 : bigtheta = 1;
   46 : //int ni = 20;
   47 :
   48 : theta0 = 0;
   49 : real lambda = 0.5;
   50 :
   51 : for(int j=0; j<25; j++){
   52 :
   53 :         for(int i=0; i<15; i++){
   54 :
   55 :         solve Poisson([theta, phi],[eta, xi]) = int2d(Th)(a*dx(theta)*dx(eta)+a*dy(theta)*dy(eta))
   56 :                    + int2d(Th)(ux * dx(theta) * eta) + int2d(Th)(uy * dy(theta) * eta) + int2d(Th)(b * ka * thetleIJSt7complexId5Õ¹a0^3 * theta * eta) - int2d(Th)(b * ka * phi * eta)
   57 :                    + int1d(Th,1)(gamma*theta*eta) - int1d(Th,1)(gamma*bigtheta*eta)
   58 :                    + int1d(Th,2)(gamma*theta*eta) - int1d(Th,2)(1*0.3*eta)
   59 :                    + int1d(Th,3)(gamma*theta*eta) - int1d(Th,3)(1*0.8*eta)
   60 :                    + int2d(Th)(alpha*dx(phi)*dx(xi)+a*dy(phi)*dy(xi)) + int2d(Th)(ka * phi * xi) - int2d(Th)(ka
leIJSt7complexId5Õ¹* theta * theta0^3 * xi)
   61 :                    + int1d(Th,1)(beta*phi*xi) - int1d(Th,1)(beta*bigtheta^4*xi)
   62 :                    + int1d(Th,2)(beta*phi*xi) - int1d(Th,2)(beta*(0.3)^4*xi)
   63 :                    + int1d(Th,3)(beta*phi*xi) - int1d(Th,3)(beta*(0.8)^4*xi);
   64 :         theta0 = (1-lambda)*theta0 + lambda*theta;
   65 :         cout << endl << "i = " << i << endl;
   66 :                                 }
   67 : //ni = 20;
   68 :
   69 : E = int1d(Th,3)(gamma*(theta-0.8)+theta*ux+b*beta*(phi-0.4096));
   70 : cout << endl << "****** E=    " << E;
   71 : cout << endl << "****** gamma=" << gamma << endl;
   72 :
   73 : gnu << gamma << " " << E << endl;
   74 :
   75 : gamma = gamma*(sqrt(10));
   76 :
   77 : plot(theta,wait=0,value=true,fill=true);
   78 : }
   79 :
   80 :
   81 :  sizestack + 1024 =8896  ( 7872 )
 
  --  mesh:  Nb of Triangles =   1072, Nb of Vertices 597
version de medit ffmedit.exe -popen -filebin 1  domain
  -- Medit,  Release 3.0a (Nov. 30, 2007)
     Copyright (c) LJLL, 1999-2007.
     compiled:  Fri, Apr 03, 2020 2:43:22 PM (with ff++ 4.6).
 
medit with binary version of popen : mesh(es)
mesh_name= domain
 Loading data file(s)
End of mesh
  Input seconds:     0.00
 
 medit1()
 
 Building scene(s)
  Creating scene 1
   Loading default options
  Scene seconds:     0.44
 
 Rendering scene(s)
 
 Total running seconds:  1.56
 Thank you for using Medit.
 kk 2 3 :   -- Solve :
          min -0.133772  max 2.83054
          min 0.454541  max 0.82247
 
i = 0
 kk 2 3 :   -- Solve :
          min -0.133777  max 1.13386
          min 0.556264  max 0.943939
 
i = 1
 kk 2 3 :   -- Solve :
          min -0.13378  max 1.13385
          min 0.548742  max 0.930226
 
i = 2
 kk 2 3 :   -- Solve :
          min -0.133781  max 1.13385
          min 0.55926  max 0.946567
 
i = 3
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13385
          min 0.559261  max 0.94682
 
i = 4
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13385
          min 0.561052  max 0.949773
 
i = 5
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13385
          min 0.56118  max 0.949973
 
i = 6
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13385
          min 0.561512  max 0.950539
 
i = 7
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13385
          min 0.561562  max 0.950615
 
i = 8
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13384
          min 0.561629  max 0.950729
 
i = 9
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13384
          min 0.561644  max 0.950753
 
i = 10
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13384
          min 0.561658  max 0.950777
 
i = 11
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13384
          min 0.561662  max 0.950784
 
i = 12
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13384
          min 0.561665  max 0.950789
 
i = 13
 kk 2 3 :   -- Solve :
          min -0.133782  max 1.13384
          min 0.561666  max 0.950791
 
i = 14
 
****** E=    -77083.8
****** gamma=10000
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950792
 
i = 0
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950792
 
i = 1
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 2
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 3
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 4
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 5
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 6
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 7
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 8
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 9
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 10
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 11
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 12
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 13
 kk 2 3 :   -- Solve :
          min -0.133916  max 1.13393
          min 0.561667  max 0.950793
 
i = 14
 
****** E=    -243824
****** gamma=31622.8
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 0
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 1
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 2
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 3
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 4
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 5
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 6
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 7
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 8
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 9
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 10
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 11
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 12
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 13
 kk 2 3 :   -- Solve :
          min -0.133959  max 1.13396
          min 0.561667  max 0.950793
 
i = 14
 
****** E=    -771103
****** gamma=100000
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 0
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 1
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 2
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 3
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 4
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 5
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 6
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 7
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 8
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 9
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 10
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 11
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 12
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 13
 kk 2 3 :   -- Solve :
          min -0.133972  max 1.13397
          min 0.561667  max 0.950793
 
i = 14
 
****** E=    -2.43851e+06
****** gamma=316228
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 0
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 1
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 2
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 3
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 4
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 5
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 6
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 7
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 8
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 9
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 10
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 11
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 12
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 13
 kk 2 3 :   -- Solve :
          min -0.133976  max 1.13397
          min 0.561667  max 0.950793
 
i = 14
 
****** E=    -7.7113e+06
****** gamma=1e+06
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 0
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 1
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 2
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 3
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 4
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 5
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 6
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 7
 kk 2 3 :   -- Solve :
          min -0.133978  max 1.13397
          min 0.561667  max 0.950793
 
i = 8
 kk 2 3 :  try getConsole D:\Study\MachineLearning\MatMod\Complex_heat_problem\M1.edp
